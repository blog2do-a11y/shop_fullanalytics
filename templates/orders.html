<!doctype html><html lang='hy'><head><meta charset='utf-8'><title>Orders</title><link rel='stylesheet' href='{{ url_for("static", filename="css/style.css") }}'></head><body><div class='container'><h1>Պատվերների ցանկ</h1><div class='actions'><a class='btn' href='{{ url_for("add") }}'>+ New Order</a> <a class='btn' href='{{ url_for("stats") }}'>Stats</a> <a class='btn' href='{{ url_for("accounting") }}'>Accounting</a></div><div class='orders-wrap'><div id='orders-list' class='orders-list'>{% for o in orders %}<div class='order-card' data-id='{{ o['Order ID'] }}' onclick="showDetail('{{ o['Order ID'] }}')"><strong>{{ o['Order ID'] }}</strong><div class='small-note'>{{ o['Full Name'] }}</div>{% if o['Image File'] %}<div><a href='{{ url_for("uploaded_file", filename=o['Image File']) }}' target='_blank'><img src='{{ url_for("uploaded_file", filename=o['Image File']) }}' class='order-img'></a></div>{% endif %}<div class='small-note'>{{ o['Order DateTime'] }}</div><div class='small-note'>Price: {{ o['Sale Price'] }}</div></div>{% endfor %}</div><div id='order-details' class='order-details'><h2>Մանրամասներ</h2><div id='detail-content'><p>Սեղմեք աջ կողմում գտնվող պատվերի վրա՝ տեսնելու ամբողջ մանրամասները.</p></div></div></div></div><script>function showDetail(id){fetch('/order/'+id).then(r=>r.json()).then(j=>{if(!j.ok){alert('Order not found');return;}const o=j.order;const c=document.getElementById('detail-content');c.innerHTML=`<p><strong>Order ID:</strong> ${o['Order ID']}</p><p><strong>Full Name:</strong> ${o['Full Name']}</p><p><strong>Phone:</strong> <a href="tel:${o['Phone / Contact']}" target="_blank">${o['Phone / Contact']}</a></p><p><strong>Social:</strong> ${o['Social Link']?('<a href="'+o['Social Link']+'" target="_blank">'+o['Social Link']+'</a>'):''}</p><p><strong>Order link:</strong> ${o['Order Link']?('<a href="'+o['Order Link']+'" target="_blank">'+o['Order Link']+'</a>'):''}</p><p><strong>Product:</strong> ${o['Product Description']}</p><p><strong>Comment:</strong> ${o['Comment']}</p><p><strong>Cost:</strong> ${o['Cost Price']} &nbsp; <strong>Sale:</strong> ${o['Sale Price']} &nbsp; <strong>Other:</strong> ${o['Other Cost']} &nbsp; <strong>Profit:</strong> ${o['Profit']}</p><p><strong>Order DateTime:</strong> ${o['Order DateTime']}</p>${ o['Image File'] ? ('<p><a href="/uploads/'+o['Image File']+'" target="_blank"><img src="/uploads/'+o['Image File']+'" style="max-width:320px;border-radius:6px;"></a></p>') : '' }<p><button onclick="doDelete('${o['Order ID']}')">Ջնջել</button></p>`;}).catch(e=>alert(e));}function doDelete(id){const code=prompt('Մուտքագրեք ջնջման կոդը (գաղտնի)'); if(code===null) return;fetch('/delete',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({order_id:id,code:code})}).then(r=>r.json()).then(j=>{if(j.ok){alert('Deleted');location.reload();}else alert('Error: '+(j.error||''));}).catch(e=>alert(e));}</script></body></html>